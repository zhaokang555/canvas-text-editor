var j=Object.defineProperty;var z=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var y=(r,t,e)=>t in r?j(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,S=(r,t)=>{for(var e in t||(t={}))Y.call(t,e)&&y(r,e,t[e]);if(z)for(var e of z(t))A.call(t,e)&&y(r,e,t[e]);return r};var i=(r,t,e)=>(y(r,typeof t!="symbol"?t+"":t,e),e);import{V as b,j as F,r as I,R as W,a as _}from"./vendor.4f28c16a.js";const V=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const h of n.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function e(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=e(o);fetch(o.href,n)}};V();class B{constructor(t,e,s,o,n){i(this,"offsetY");i(this,"calcLayoutForChars",()=>{let t=this.left;this.chars.forEach(e=>{e.setPosition(t,this.top+this.offsetY),t+=e.width})});this.chars=t,this.width=e,this.height=s,this.left=o,this.top=n,this.offsetY=Math.max(...this.chars.map(h=>h.textMetrics.fontBoundingBoxAscent)),this.calcLayoutForChars(),this.chars.forEach((h,l)=>{h.prev=this.chars[l-1]||null})}}class ${constructor(t,e,s,o,n){i(this,"softLines",[]);i(this,"width",0);i(this,"height",0);i(this,"calcLayoutForSoftLines",()=>{let t=[],e=0,s=0,o=this.top;if(this.chars.forEach(n=>{if(t.length===0)t.push(n),e+=n.width,s=Math.max(s,n.height);else if(e+n.width<=this.maxWidth)t.push(n),e+=n.width,s=Math.max(s,n.height);else{const h=new B(t,e,s,this.left,o);this.softLines.push(h),o+=s,t=[n],e=n.width,s=n.height}}),t.length>0){const n=new B(t,e,s,this.left,o);this.softLines.push(n)}});i(this,"calcLayout",()=>{this.width=Math.max(...this.softLines.map(t=>t.width)),this.height=this.softLines.reduce((t,e)=>t+e.height,0)});i(this,"render",()=>{this.chars.forEach(t=>t.render())});this.chars=t,this.store=e,this.left=s,this.top=o,this.maxWidth=n,this.calcLayoutForSoftLines(),this.calcLayout()}destructor(){this.chars.forEach(t=>t.destructor())}}var L;(function(r){r.defaultCursor="default",r.ewResize="ew-resize",r.nsResize="ns-resize",r.neswResize="nesw-resize",r.nwseResize="nwse-resize",r.move="move",r.text="text"})(L||(L={}));var p=L;class g{constructor(t,e,s,o,n,h,l={}){i(this,"zIndex",0);i(this,"isMouseHovering",!1);i(this,"handleMouseMove",t=>{const e=this.store.ctx.canvas.getBoundingClientRect(),s=t.clientX-e.left,o=t.clientY-e.top;this.isMouseHovering=s>=this.left&&o>=this.top&&s<=this.left+this.width&&o<=this.top+this.height});this.left=t,this.top=e,this.width=s,this.height=o,this.cursorType=n,this.store=h,Object.entries(l).forEach(([c,f])=>this[c]=f),h.ctx.canvas.addEventListener("mousemove",this.handleMouseMove)}destructor(){this.store.ctx.canvas.removeEventListener("mousemove",this.handleMouseMove)}render(){this.isMouseHovering&&this.zIndex>=this.store.mouse.hover.topLayerZIndex&&(this.store.mouse.hover.topLayerZIndex=this.zIndex,this.store.mouse.hover.topLayerCursorType=this.cursorType)}}i(g,"topLayerZIndex",-1/0),i(g,"topLayerCursorType",p.defaultCursor);class x{constructor(t,e,s,o,n,h,l={}){i(this,"zIndex",0);i(this,"handleClick",t=>{const e=this.store.ctx.canvas.getBoundingClientRect(),s=t.clientX-e.left,o=t.clientY-e.top;s>=this.left&&o>=this.top&&s<=this.left+this.width&&o<=this.top+this.height&&(this.zIndex>this.store.mouse.click.topLayerZIndex?(this.store.mouse.click.topLayerCallbacks=[()=>this.onClick(s,o)],this.store.mouse.click.topLayerZIndex=this.zIndex):this.zIndex===this.store.mouse.click.topLayerZIndex&&this.store.mouse.click.topLayerCallbacks.push(()=>this.onClick(s,o)))});this.left=t,this.top=e,this.width=s,this.height=o,this.onClick=n,this.store=h,Object.entries(l).forEach(([c,f])=>this[c]=f),this.store.ctx.canvas.addEventListener("click",this.handleClick)}destructor(){this.store.ctx.canvas.removeEventListener("click",this.handleClick)}}i(x,"topLayerZIndex",-1/0),i(x,"topLayerCallbacks",[]);const q="rgba(0, 0, 0, 0.15)";class N{constructor(t,e,s,o,n){i(this,"isSelected",!1);this.left=t,this.top=e,this.width=s,this.height=o,this.store=n}render(){this.isSelected&&(this.store.ctx.fillStyle=q,this.store.ctx.fillRect(this.left,this.top,this.width,this.height))}}class X{}class Z{constructor(t){i(this,"mousedownZone");this.clickableZone=t,this.mousedownZone=new X}setPosition(t,e){}}const v=10;class a{constructor(t,e,s,o={}){i(this,"textMetrics");i(this,"top",0);i(this,"color","#000");i(this,"fontSize",50);i(this,"prev",null);i(this,"boundingBox");i(this,"leftHalf");i(this,"rightHalf");i(this,"selectableZone");i(this,"setPosition",(t,e)=>{this.top=e;const s=e-this.textMetrics.fontBoundingBoxAscent;this.boundingBox.left=t,this.boundingBox.top=s,this.leftHalf.clickableZone.left=t,this.leftHalf.clickableZone.top=s,this.rightHalf.clickableZone.left=t+this.width/2,this.rightHalf.clickableZone.top=s,this.selectableZone.left=t,this.selectableZone.top=s});i(this,"render",()=>{this.boundingBox.render(),this.selectableZone.render(),this.setStyle(),this.store.ctx.fillText(this.char,this.left,this.top)});i(this,"handleClickLeft",()=>{this.prev?(this.blinkingCursor.left=this.prev.rightHalf.clickableZone.left+this.prev.rightHalf.clickableZone.width,this.blinkingCursor.top=this.prev.rightHalf.clickableZone.top,this.blinkingCursor.height=this.prev.fontSize):(this.blinkingCursor.left=this.leftHalf.clickableZone.left,this.blinkingCursor.top=this.leftHalf.clickableZone.top,this.blinkingCursor.height=this.fontSize),this.blinkingCursor.show()});i(this,"handleClickRight",()=>{this.blinkingCursor.left=this.rightHalf.clickableZone.left+this.rightHalf.clickableZone.width,this.blinkingCursor.top=this.rightHalf.clickableZone.top,this.blinkingCursor.height=this.fontSize,this.blinkingCursor.show()});this.char=t,this.store=e,this.blinkingCursor=s,Object.entries(o).forEach(([l,c])=>this[l]=c),this.setStyle(),this.textMetrics=e.ctx.measureText(t);const n=this.textMetrics.width,h=this.textMetrics.fontBoundingBoxDescent+this.textMetrics.fontBoundingBoxAscent;this.boundingBox=new g(-1/0,-1/0,n,h,p.text,e,{zIndex:v}),this.leftHalf=new Z(new x(-1/0,-1/0,n/2,h,this.handleClickLeft,e,{zIndex:v})),this.rightHalf=new Z(new x(-1/0,-1/0,n/2,h,this.handleClickRight,e,{zIndex:v})),this.selectableZone=new N(-1/0,-1/0,n,h,e)}get left(){return this.boundingBox.left}get boundingBoxTop(){return this.boundingBox.top}get width(){return this.boundingBox.width}get height(){return this.boundingBox.height}destructor(){this.boundingBox.destructor(),this.leftHalf.clickableZone.destructor(),this.rightHalf.clickableZone.destructor()}setStyle(){this.store.ctx.fillStyle=this.color,this.store.ctx.font=`${this.fontSize}px sans-serif`}}const w=5,K=1e3;class d extends g{constructor(t,e,s,o,n={}){const h=t-w,l=e-w,c=2*w,f=2*w;super(h,l,c,f,s,o,S({zIndex:K},n));i(this,"borderColor","#999");i(this,"backgroundColor","#fff");i(this,"render",()=>{super.render(),this.store.ctx.beginPath(),this.store.ctx.setLineDash([]),this.store.ctx.arc(this.centerX,this.centerY,w,0,Math.PI*2),this.store.ctx.fillStyle=this.backgroundColor,this.store.ctx.fill(),this.store.ctx.strokeStyle=this.borderColor,this.store.ctx.stroke(),this.store.ctx.closePath()});this.centerX=t,this.centerY=e,this.cursorType=s}}const G="#999",J=1,k=10,Q=100;class C extends g{constructor(t,e,s){const o=e.clone().subtract(t).rotate(Math.PI/2).normalize(),n=[t.clone().add(o.clone().multiplyScalar(k/2)),t.clone().add(o.clone().multiplyScalar(-k/2)),e.clone().add(o.clone().multiplyScalar(k/2)),e.clone().add(o.clone().multiplyScalar(-k/2))],h=Math.min(...n.map(u=>u.x)),l=Math.min(...n.map(u=>u.y)),c=Math.max(...n.map(u=>u.x)),f=Math.max(...n.map(u=>u.y)),O=c-h,D=f-l;super(h,l,O,D,p.move,s,{zIndex:Q});this.from=t,this.to=e}render(){super.render(),this.store.ctx.beginPath(),this.store.ctx.strokeStyle=G,this.store.ctx.lineWidth=J,this.store.ctx.setLineDash([3]),this.store.ctx.moveTo(this.from.x,this.from.y),this.store.ctx.lineTo(this.to.x,this.to.y),this.store.ctx.stroke()}}const{round:M}=Math,E=1e3;class U{constructor(t){i(this,"height",50);i(this,"startBlinkingTimestamp",0);i(this,"_left",-1/0);i(this,"_top",-1/0);this.store=t}get left(){return this._left}set left(t){this._left=M(t)}get top(){return this._top}set top(t){this._top=M(t)}show(){this.startBlinkingTimestamp=Date.now()}render(){(Date.now()-this.startBlinkingTimestamp)%E/E<.5&&(this.store.ctx.beginPath(),this.store.ctx.moveTo(this.left,this.top),this.store.ctx.lineTo(this.left,this.top+this.height),this.store.ctx.strokeStyle="#000",this.store.ctx.lineWidth=1,this.store.ctx.stroke())}}class tt{constructor(t){i(this,"mouse",{click:{topLayerZIndex:-1/0,topLayerCallbacks:[]},hover:{topLayerZIndex:-1/0,topLayerCursorType:p.defaultCursor}});this.ctx=t}}const{defaultCursor:et,ewResize:T,nsResize:H,neswResize:R,nwseResize:P}=p;class st{constructor(t,e={}){i(this,"canvas");i(this,"store");i(this,"left",0);i(this,"top",0);i(this,"width",400);i(this,"height",300);i(this,"backgroundColor","#fff");i(this,"paddingLeft",10);i(this,"paragraphs",[]);i(this,"sizeControlPoints",[]);i(this,"borders",[]);i(this,"blinkingCursor");i(this,"blankSpace");i(this,"render",()=>{requestAnimationFrame(this.render),this.clearCanvas(),this.paragraphs.forEach(t=>t.render()),this.borders.forEach(t=>t.render()),this.sizeControlPoints.forEach(t=>t.render()),this.blinkingCursor.render(),this.canvas.style.cursor=this.store.mouse.hover.topLayerCursorType,this.store.mouse.click.topLayerCallbacks.forEach(t=>t()),this.store.mouse.click.topLayerCallbacks=[],this.store.mouse.click.topLayerZIndex=-1/0});i(this,"clearCanvas",()=>{this.store.ctx.fillStyle=this.backgroundColor,this.store.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.store.mouse.hover.topLayerZIndex=-1/0,this.store.mouse.hover.topLayerCursorType=et});i(this,"handleClickOnTheBlankSpace",(t,e)=>{let s=null,o=1/0;for(let l of this.paragraphs)for(let c of l.softLines){const f=e-c.top;(s==null||f>=0&&f<o)&&(s=c,o=f)}if(s==null)return;if(t<=s.chars[0].left){s.chars[0].handleClickLeft();return}let n=s.chars[0],h=t-n.left;for(let l of s.chars){const c=t-l.left;c>=0&&c<h&&(n=l,h=c)}h<=n.width/2?n.handleClickLeft():n.handleClickRight()});Object.entries(e).forEach(([o,n])=>this[o]=n),this.canvas=t;const s=this.canvas.getContext("2d");this.store=new tt(s),this.blankSpace=new x(this.left,this.top,this.width,this.height,this.handleClickOnTheBlankSpace,this.store),this.blinkingCursor=new U(this.store),this.initParagraphs(),this.initBorder(),this.initSizeControlPoints(),this.moveBlinkingCursorToEnd(),requestAnimationFrame(this.render)}destructor(){this.paragraphs.forEach(t=>t.destructor()),this.borders.forEach(t=>t.destructor()),this.sizeControlPoints.forEach(t=>t.destructor())}initParagraphs(){this.paragraphs=[new $([new a("/",this.store,this.blinkingCursor,{color:"red",fontSize:80}),new a("t",this.store,this.blinkingCursor,{color:"orange",fontSize:80}),new a("h",this.store,this.blinkingCursor,{color:"yellow",fontSize:80}),new a("o",this.store,this.blinkingCursor,{color:"green",fontSize:80}),new a("u",this.store,this.blinkingCursor,{color:"lightblue",fontSize:80}),new a("g",this.store,this.blinkingCursor,{color:"blue",fontSize:80}),new a("h",this.store,this.blinkingCursor,{color:"purple",fontSize:80}),new a("t",this.store,this.blinkingCursor,{color:"red",fontSize:80}),new a("w",this.store,this.blinkingCursor,{color:"orange",fontSize:80}),new a("o",this.store,this.blinkingCursor,{color:"yellow",fontSize:80}),new a("r",this.store,this.blinkingCursor,{color:"green",fontSize:80}),new a("k",this.store,this.blinkingCursor,{color:"lightblue",fontSize:80}),new a("s",this.store,this.blinkingCursor,{color:"blue",fontSize:80}),new a("\u601D",this.store,this.blinkingCursor,{color:"purple",fontSize:80}),new a("\u7279",this.store,this.blinkingCursor,{color:"red",fontSize:80}),new a("\u6C83",this.store,this.blinkingCursor,{color:"orange",fontSize:80}),new a("\u514B",this.store,this.blinkingCursor,{color:"yellow",fontSize:80})],this.store,this.left+this.paddingLeft,this.top,this.width-this.paddingLeft)]}initBorder(){const t=new b(this.left,this.top),e=new b(this.left+this.width,this.top),s=new b(this.left,this.top+this.height),o=new b(this.left+this.width,this.top+this.height);this.borders=[new C(t,e,this.store),new C(e,o,this.store),new C(o,s,this.store),new C(s,t,this.store)]}initSizeControlPoints(){this.sizeControlPoints=[new d(this.left,this.top,P,this.store),new d(this.left,this.top+this.height/2,T,this.store),new d(this.left,this.top+this.height,R,this.store),new d(this.left+this.width/2,this.top,H,this.store),new d(this.left+this.width/2,this.top+this.height,H,this.store),new d(this.left+this.width,this.top,R,this.store),new d(this.left+this.width,this.top+this.height/2,T,this.store),new d(this.left+this.width,this.top+this.height,P,this.store)]}moveBlinkingCursorToEnd(){const t=this.blinkingCursor;if(this.paragraphs.length>0){const e=this.paragraphs[this.paragraphs.length-1],s=e.chars[e.chars.length-1];t.left=s.left+s.width,t.top=s.boundingBoxTop,t.height=s.fontSize}else t.left=this.left+this.paddingLeft,t.top=this.top;t.show()}}const m=F.exports.jsx;function it(){const r=I.exports.useRef(null);return I.exports.useEffect(()=>{r.current&&new st(r.current,{left:100,top:100})},[]),m("div",{children:m("canvas",{ref:r,width:"800",height:"600"})})}W.render(m(_.StrictMode,{children:m(it,{})}),document.getElementById("root"));
