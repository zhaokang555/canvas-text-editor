var Y=Object.defineProperty;var I=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var L=(h,t,i)=>t in h?Y(h,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):h[t]=i,B=(h,t)=>{for(var i in t||(t={}))A.call(t,i)&&L(h,i,t[i]);if(I)for(var i of I(t))F.call(t,i)&&L(h,i,t[i]);return h};var n=(h,t,i)=>(L(h,typeof t!="symbol"?t+"":t,i),i);import{V as C,j as V,r as M,R as $,a as q}from"./vendor.4f28c16a.js";const N=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&e(l)}).observe(document,{childList:!0,subtree:!0});function i(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(s){if(s.ep)return;s.ep=!0;const o=i(s);fetch(s.href,o)}};N();class E{constructor(t,i,e,s,o,l){n(this,"offsetY");n(this,"calcLayoutForChars",()=>{let t=this.left;this.chars.forEach(i=>{i.setPosition(t,this.top+this.offsetY),t+=i.width})});this.chars=t,this.width=i,this.height=e,this.ctx=s,this.left=o,this.top=l,this.offsetY=Math.max(...this.chars.map(c=>c.textMetrics.fontBoundingBoxAscent)),this.calcLayoutForChars(),this.chars.forEach((c,a)=>{c.prev=this.chars[a-1]||null})}}class X{constructor(t,i,e,s,o){n(this,"softLines",[]);n(this,"width",0);n(this,"height",0);n(this,"calcLayoutForSoftLines",()=>{let t=[],i=0,e=0,s=this.top;if(this.chars.forEach(o=>{if(t.length===0)t.push(o),i+=o.width,e=Math.max(e,o.height);else if(i+o.width<=this.maxWidth)t.push(o),i+=o.width,e=Math.max(e,o.height);else{const l=new E(t,i,e,this.ctx,this.left,s);this.softLines.push(l),s+=e,t=[o],i=o.width,e=o.height}}),t.length>0){const o=new E(t,i,e,this.ctx,this.left,s);this.softLines.push(o)}});n(this,"calcLayout",()=>{this.width=Math.max(...this.softLines.map(t=>t.width)),this.height=this.softLines.reduce((t,i)=>t+i.height,0)});n(this,"render",()=>{this.chars.forEach(t=>t.render())});this.chars=t,this.ctx=i,this.left=e,this.top=s,this.maxWidth=o,this.calcLayoutForSoftLines(),this.calcLayout()}destructor(){this.chars.forEach(t=>t.destructor())}}var S;(function(h){h.defaultCursor="default",h.ewResize="ew-resize",h.nsResize="ns-resize",h.neswResize="nesw-resize",h.nwseResize="nwse-resize",h.move="move",h.text="text"})(S||(S={}));var k=S;const w=class{constructor(t,i,e,s,o,l,c={}){n(this,"zIndex",0);n(this,"isMouseHovering",!1);n(this,"handleMouseMove",t=>{const i=this.ctx.canvas.getBoundingClientRect(),e=t.clientX-i.left,s=t.clientY-i.top;this.isMouseHovering=e>=this.left&&s>=this.top&&e<=this.left+this.width&&s<=this.top+this.height});this.left=t,this.top=i,this.width=e,this.height=s,this.cursorType=o,this.ctx=l,Object.entries(c).forEach(([a,f])=>this[a]=f),l.canvas.addEventListener("mousemove",this.handleMouseMove)}destructor(){this.ctx.canvas.removeEventListener("mousemove",this.handleMouseMove)}render(){this.isMouseHovering&&this.zIndex>=w.topLayerZIndex&&(w.topLayerZIndex=this.zIndex,w.topLayerCursorType=this.cursorType)}};let d=w;n(d,"topLayerZIndex",-1/0),n(d,"topLayerCursorType",k.defaultCursor);const x=class{constructor(t,i,e,s,o,l,c={}){n(this,"zIndex",0);n(this,"handleClick",t=>{const i=this.ctx.canvas.getBoundingClientRect(),e=t.clientX-i.left,s=t.clientY-i.top;e>=this.left&&s>=this.top&&e<=this.left+this.width&&s<=this.top+this.height&&(this.zIndex>x.topLayerZIndex?(x.topLayerCallbacks=[()=>this.onClick(e,s)],x.topLayerZIndex=this.zIndex):this.zIndex===x.topLayerZIndex&&x.topLayerCallbacks.push(()=>this.onClick(e,s)))});this.left=t,this.top=i,this.width=e,this.height=s,this.onClick=o,this.ctx=l,Object.entries(c).forEach(([a,f])=>this[a]=f),l.canvas.addEventListener("click",this.handleClick)}destructor(){this.ctx.canvas.removeEventListener("click",this.handleClick)}};let u=x;n(u,"topLayerZIndex",-1/0),n(u,"topLayerCallbacks",[]);const K="rgba(0, 0, 0, 0.15)";class G{constructor(t,i,e,s,o){n(this,"isSelected",!1);this.left=t,this.top=i,this.width=e,this.height=s,this.ctx=o}render(){this.isSelected&&(this.ctx.fillStyle=K,this.ctx.fillRect(this.left,this.top,this.width,this.height))}}class Z{constructor(t){this.clickableZone=t}}const v=10;class r{constructor(t,i,e,s={}){n(this,"textMetrics");n(this,"top",0);n(this,"color","#000");n(this,"fontSize",50);n(this,"prev",null);n(this,"boundingBox");n(this,"leftHalf");n(this,"rightHalf");n(this,"selectableZone");n(this,"setPosition",(t,i)=>{this.top=i;const e=i-this.textMetrics.fontBoundingBoxAscent;this.boundingBox.left=t,this.boundingBox.top=e,this.leftHalf.clickableZone.left=t,this.leftHalf.clickableZone.top=e,this.rightHalf.clickableZone.left=t+this.width/2,this.rightHalf.clickableZone.top=e,this.selectableZone.left=t,this.selectableZone.top=e});n(this,"render",()=>{this.boundingBox.render(),this.selectableZone.render(),this.setStyle(),this.ctx.fillText(this.char,this.left,this.top)});n(this,"handleClickLeft",()=>{this.prev?(this.blinkingCursor.left=this.prev.rightHalf.clickableZone.left+this.prev.rightHalf.clickableZone.width,this.blinkingCursor.top=this.prev.rightHalf.clickableZone.top,this.blinkingCursor.height=this.prev.fontSize):(this.blinkingCursor.left=this.leftHalf.clickableZone.left,this.blinkingCursor.top=this.leftHalf.clickableZone.top,this.blinkingCursor.height=this.fontSize),this.blinkingCursor.show()});n(this,"handleClickRight",()=>{this.blinkingCursor.left=this.rightHalf.clickableZone.left+this.rightHalf.clickableZone.width,this.blinkingCursor.top=this.rightHalf.clickableZone.top,this.blinkingCursor.height=this.fontSize,this.blinkingCursor.show()});this.char=t,this.ctx=i,this.blinkingCursor=e,Object.entries(s).forEach(([c,a])=>this[c]=a),this.setStyle(),this.textMetrics=i.measureText(t);const o=this.textMetrics.width,l=this.textMetrics.fontBoundingBoxDescent+this.textMetrics.fontBoundingBoxAscent;this.boundingBox=new d(-1/0,-1/0,o,l,k.text,i,{zIndex:v}),this.leftHalf=new Z(new u(-1/0,-1/0,o/2,l,this.handleClickLeft,i,{zIndex:v})),this.rightHalf=new Z(new u(-1/0,-1/0,o/2,l,this.handleClickRight,i,{zIndex:v})),this.selectableZone=new G(-1/0,-1/0,o,l,i)}get left(){return this.boundingBox.left}get boundingBoxTop(){return this.boundingBox.top}get width(){return this.boundingBox.width}get height(){return this.boundingBox.height}destructor(){this.boundingBox.destructor(),this.leftHalf.clickableZone.destructor(),this.rightHalf.clickableZone.destructor()}setStyle(){this.ctx.fillStyle=this.color,this.ctx.font=`${this.fontSize}px sans-serif`}}const b=5,J=1e3;class g extends d{constructor(t,i,e,s,o={}){const l=t-b,c=i-b,a=2*b,f=2*b;super(l,c,a,f,e,s,B({zIndex:J},o));n(this,"borderColor","#999");n(this,"backgroundColor","#fff");n(this,"render",()=>{super.render(),this.ctx.beginPath(),this.ctx.setLineDash([]),this.ctx.arc(this.centerX,this.centerY,b,0,Math.PI*2),this.ctx.fillStyle=this.backgroundColor,this.ctx.fill(),this.ctx.strokeStyle=this.borderColor,this.ctx.stroke(),this.ctx.closePath()});this.centerX=t,this.centerY=i,this.cursorType=e}}const Q="#999",U=1,y=10,_=100;class m extends d{constructor(t,i,e){const s=i.clone().subtract(t).rotate(Math.PI/2).normalize(),o=[t.clone().add(s.clone().multiplyScalar(y/2)),t.clone().add(s.clone().multiplyScalar(-y/2)),i.clone().add(s.clone().multiplyScalar(y/2)),i.clone().add(s.clone().multiplyScalar(-y/2))],l=Math.min(...o.map(p=>p.x)),c=Math.min(...o.map(p=>p.y)),a=Math.max(...o.map(p=>p.x)),f=Math.max(...o.map(p=>p.y)),j=a-l,W=f-c;super(l,c,j,W,k.move,e,{zIndex:_});this.from=t,this.to=i}render(){super.render(),this.ctx.beginPath(),this.ctx.strokeStyle=Q,this.ctx.lineWidth=U,this.ctx.setLineDash([3]),this.ctx.moveTo(this.from.x,this.from.y),this.ctx.lineTo(this.to.x,this.to.y),this.ctx.stroke()}}const{round:T}=Math,H=1e3;class tt{constructor(t){n(this,"height",50);n(this,"startBlinkingTimestamp",0);n(this,"_left",-1/0);n(this,"_top",-1/0);this.ctx=t}get left(){return this._left}set left(t){this._left=T(t)}get top(){return this._top}set top(t){this._top=T(t)}show(){this.startBlinkingTimestamp=Date.now()}render(){(Date.now()-this.startBlinkingTimestamp)%H/H<.5&&(this.ctx.beginPath(),this.ctx.moveTo(this.left,this.top),this.ctx.lineTo(this.left,this.top+this.height),this.ctx.strokeStyle="#000",this.ctx.lineWidth=1,this.ctx.stroke())}}const{defaultCursor:it,ewResize:R,nsResize:P,neswResize:O,nwseResize:D}=k;class et{constructor(t,i={}){n(this,"canvas");n(this,"ctx");n(this,"left",0);n(this,"top",0);n(this,"width",400);n(this,"height",300);n(this,"backgroundColor","#fff");n(this,"paddingLeft",10);n(this,"paragraphs",[]);n(this,"sizeControlPoints",[]);n(this,"borders",[]);n(this,"blinkingCursor");n(this,"blankSpace");n(this,"render",()=>{requestAnimationFrame(this.render),this.clearCanvas(),this.paragraphs.forEach(t=>t.render()),this.borders.forEach(t=>t.render()),this.sizeControlPoints.forEach(t=>t.render()),this.blinkingCursor.render(),this.canvas.style.cursor=d.topLayerCursorType,u.topLayerCallbacks.forEach(t=>t()),u.topLayerCallbacks=[],u.topLayerZIndex=-1/0});n(this,"clearCanvas",()=>{this.ctx.fillStyle=this.backgroundColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),d.topLayerZIndex=-1/0,d.topLayerCursorType=it});n(this,"handleClickOnTheBlankSpace",(t,i)=>{let e=null,s=1/0;for(let c of this.paragraphs)for(let a of c.softLines){const f=i-a.top;(e==null||f>=0&&f<s)&&(e=a,s=f)}if(e==null)return;if(t<=e.chars[0].left){e.chars[0].handleClickLeft();return}let o=e.chars[0],l=t-o.left;for(let c of e.chars){const a=t-c.left;a>=0&&a<l&&(o=c,l=a)}l<=o.width/2?o.handleClickLeft():o.handleClickRight()});Object.entries(i).forEach(([e,s])=>this[e]=s),this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.blankSpace=new u(this.left,this.top,this.width,this.height,this.handleClickOnTheBlankSpace,this.ctx),this.blinkingCursor=new tt(this.ctx),this.initParagraphs(),this.initBorder(),this.initSizeControlPoints(),this.moveBlinkingCursorToEnd(),requestAnimationFrame(this.render)}destructor(){this.paragraphs.forEach(t=>t.destructor()),this.borders.forEach(t=>t.destructor()),this.sizeControlPoints.forEach(t=>t.destructor())}initParagraphs(){this.paragraphs=[new X([new r("W",this.ctx,this.blinkingCursor,{color:"red",fontSize:60}),new r("o",this.ctx,this.blinkingCursor,{color:"orange",fontSize:60}),new r("r",this.ctx,this.blinkingCursor,{color:"yellow",fontSize:60}),new r("k",this.ctx,this.blinkingCursor,{color:"green",fontSize:60}),new r("e",this.ctx,this.blinkingCursor,{color:"lightblue",fontSize:60}),new r("r",this.ctx,this.blinkingCursor,{color:"blue",fontSize:60}),new r("s",this.ctx,this.blinkingCursor,{color:"purple",fontSize:40}),new r(" ",this.ctx,this.blinkingCursor),new r("o",this.ctx,this.blinkingCursor,{color:"orange",fontSize:40}),new r("f",this.ctx,this.blinkingCursor,{color:"yellow",fontSize:40}),new r(" ",this.ctx,this.blinkingCursor),new r("t",this.ctx,this.blinkingCursor,{color:"lightblue",fontSize:40}),new r("h",this.ctx,this.blinkingCursor,{color:"blue",fontSize:40}),new r("e",this.ctx,this.blinkingCursor,{color:"purple",fontSize:40}),new r(" ",this.ctx,this.blinkingCursor),new r("w",this.ctx,this.blinkingCursor,{color:"orange",fontSize:60}),new r("o",this.ctx,this.blinkingCursor,{color:"yellow",fontSize:60}),new r("r",this.ctx,this.blinkingCursor,{color:"green",fontSize:60}),new r("l",this.ctx,this.blinkingCursor,{color:"lightblue",fontSize:60}),new r("d",this.ctx,this.blinkingCursor,{color:"blue",fontSize:60}),new r(",",this.ctx,this.blinkingCursor,{color:"purple",fontSize:60}),new r(" ",this.ctx,this.blinkingCursor),new r("u",this.ctx,this.blinkingCursor,{color:"orange",fontSize:60}),new r("n",this.ctx,this.blinkingCursor,{color:"yellow",fontSize:60}),new r("i",this.ctx,this.blinkingCursor,{color:"green",fontSize:60}),new r("t",this.ctx,this.blinkingCursor,{color:"lightblue",fontSize:60}),new r("e",this.ctx,this.blinkingCursor,{color:"blue",fontSize:60}),new r("!",this.ctx,this.blinkingCursor,{color:"purple",fontSize:60})],this.ctx,this.left+this.paddingLeft,this.top,this.width-this.paddingLeft)]}initBorder(){const t=new C(this.left,this.top),i=new C(this.left+this.width,this.top),e=new C(this.left,this.top+this.height),s=new C(this.left+this.width,this.top+this.height);this.borders=[new m(t,i,this.ctx),new m(i,s,this.ctx),new m(s,e,this.ctx),new m(e,t,this.ctx)]}initSizeControlPoints(){this.sizeControlPoints=[new g(this.left,this.top,D,this.ctx),new g(this.left,this.top+this.height/2,R,this.ctx),new g(this.left,this.top+this.height,O,this.ctx),new g(this.left+this.width/2,this.top,P,this.ctx),new g(this.left+this.width/2,this.top+this.height,P,this.ctx),new g(this.left+this.width,this.top,O,this.ctx),new g(this.left+this.width,this.top+this.height/2,R,this.ctx),new g(this.left+this.width,this.top+this.height,D,this.ctx)]}moveBlinkingCursorToEnd(){const t=this.blinkingCursor;if(this.paragraphs.length>0){const i=this.paragraphs[this.paragraphs.length-1],e=i.chars[i.chars.length-1];t.left=e.left+e.width,t.top=e.boundingBoxTop,t.height=e.fontSize}else t.left=this.left+this.paddingLeft,t.top=this.top;t.show()}}const z=V.exports.jsx;function st(){const h=M.exports.useRef(null);return M.exports.useEffect(()=>{h.current&&new et(h.current,{left:100,top:100})},[]),z("div",{children:z("canvas",{ref:h,width:"800",height:"600"})})}$.render(z(q.StrictMode,{children:z(st,{})}),document.getElementById("root"));
